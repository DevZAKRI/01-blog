<h2 mat-dialog-title>Comments ({{ totalComments }})</h2>
<mat-dialog-content>
  <div class="comments-container">
    <app-comment-list
      [comments]="comments"
      [postId]="data.postId"
      (delete)="onDeleteComment($event)">
    </app-comment-list>

    <div class="loading" *ngIf="isLoading">
      <mat-spinner diameter="40"></mat-spinner>
    </div>

    <div class="no-comments" *ngIf="!isLoading && comments.length === 0">
      <p>No comments yet. Be the first to comment!</p>
    </div>

    <mat-paginator
      [length]="totalComments"
      [pageSize]="pageSize"
      [pageSizeOptions]="[5, 10, 20]"
      (page)="onPageChange($event)"
      *ngIf="totalComments > pageSize && !isLoading">
    </mat-paginator>
  </div>

  <div class="comment-form">
    <form [formGroup]="commentForm" (ngSubmit)="onSubmit()">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Add a comment</mat-label>
        <textarea matInput
                  formControlName="text"
                  rows="2"
                  placeholder="Write your comment..."></textarea>
        <mat-hint>{{ commentForm.get('text')?.value?.length || 0 }} / 500</mat-hint>
        <mat-error *ngIf="commentForm.get('text')?.hasError('required')">
          Comment text is required
        </mat-error>
        <mat-error *ngIf="commentForm.get('text')?.hasError('maxlength')">
          Comment cannot exceed 500 characters
        </mat-error>
      </mat-form-field>
      <button mat-raised-button color="primary" type="submit"
              [disabled]="isSubmitting || commentForm.invalid">
        <mat-spinner diameter="20" *ngIf="isSubmitting"></mat-spinner>
        <span *ngIf="!isSubmitting">Comment</span>
      </button>
    </form>
  </div>
</mat-dialog-content>
<mat-dialog-actions align="end">
  <button mat-button (click)="onClose()">Close</button>
</mat-dialog-actions>
